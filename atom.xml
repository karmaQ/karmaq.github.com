<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[CilaCila]]></title>
  <link href="http://karmaQ.github.com/atom.xml" rel="self"/>
  <link href="http://karmaQ.github.com/"/>
  <updated>2012-08-14T08:50:41+08:00</updated>
  <id>http://karmaQ.github.com/</id>
  <author>
    <name><![CDATA[Karma]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[[code complete]tips]]></title>
    <link href="http://karmaQ.github.com/blog/2012/08/03/code-complete-tips/"/>
    <updated>2012-08-03T15:56:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/08/03/code-complete-tips</id>
    <content type="html"><![CDATA[<h1>The Power of Variable Names</h1>

<ul>
<li>以问题为导向(Problem Orientation)

<ul>
<li>一个好的名字表达的是what而不是how</li>
</ul>
</li>
<li>最适当的名字长度:8-20</li>
<li></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Keep finders on their own model]]></title>
    <link href="http://karmaQ.github.com/blog/2012/07/05/keep-finders-on-their-own-model/"/>
    <updated>2012-07-05T16:12:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/07/05/keep-finders-on-their-own-model</id>
    <content type="html"><![CDATA[<p><strong>solution but needs your judgment</strong></p>

<pre><code>class User &lt; ActiveRecord::Base
    has_many :memberships       def find_recent_active_memberships
        memberships.only_active.order_by_activity.limit(5)      end end
class Membership &lt; ActiveRecord::Base       belongs_to :user        scope :only_active, where(:active =&gt; true)      scope :order_by_activity, order('last_active_on DESC')  end
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Put All find() calls into finders on the model]]></title>
    <link href="http://karmaQ.github.com/blog/2012/07/05/put-all-find-calls-into-finders-on-the-model/"/>
    <updated>2012-07-05T15:28:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/07/05/put-all-find-calls-into-finders-on-the-model</id>
    <content type="html"><![CDATA[<pre><code>&lt;ul&gt;        &lt;% User.find(:order =&gt; "last_name").each do |user| -%&gt;      &lt;li&gt;&lt;%= user.last_name %&gt; &lt;%= user.first_name %&gt;&lt;/li&gt; &lt;% end %&gt; &lt;/ul&gt;
</code></pre>

<p>===========></p>

<pre><code>class UsersController &lt; ApplicationController def index     @users = User.order("last_name") end    end

&lt;ul&gt;        &lt;% @users.each do |user| -%&gt;        &lt;li&gt;&lt;%= user.last_name %&gt; &lt;%= user.first_name %&gt;&lt;/li&gt; &lt;% end %&gt; &lt;/ul&gt;===========&gt;
class UsersController &lt; ApplicationController       def index           @users = User.ordered       end end

class User &lt; ActiveRecord::Base 
    def self.ordered            order("last_name")      end end
</code></pre>

<p><strong>Solution</strong>        class User &lt; ActiveRecord::Base     scope :ordered, order(&#8220;last_name&#8221;)  end</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Follow the law of Demeter]]></title>
    <link href="http://karmaQ.github.com/blog/2012/06/27/follow-the-law-of-demeter/"/>
    <updated>2012-06-27T14:59:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/06/27/follow-the-law-of-demeter</id>
    <content type="html"><![CDATA[<h3>Follow the law of Demeter</h3>

<pre><code>class Address &lt; ActiveRecord::Base 
    belongs_to :customer    end
class Customer &lt; ActiveRecord::Base         has_one :address        has_many :invoices  end
class Invoice &lt; ActiveRecord::Base 
    belongs_to :customer    end
# Views

&lt;%= @invoice.customer.name %&gt;   &lt;%= @invoice.customer.address.street %&gt; 
&lt;%= @invoice.customer.address.city %&gt;
&lt;%= @invoice.customer.address.state %&gt;
&lt;%= @invoice.customer.address.zip_code %&gt;
</code></pre>

<p>Law of Demeter:
lays out the concept that an object can call methods on a related object but that it should not reach through that object to call a method on a third. In Rails, this could be summed up as “use only one dot.”</p>

<p>So we can write a method :</p>

<pre><code>class Customer &lt; ActiveRecord::Base 
    has_one :address        has_many :invoices      def street          address.street      end     def city 
        address.city        end     def state           address.state       end
end

&lt;%= @invoice.customer_name %&gt;
&lt;%= @invoice.customer_street %&gt;
</code></pre>

<p>In addition, your public interface on Invoice has been polluted by methods that arguably have nothing to do with the rest of your interface for invoices.</p>

<p><strong>Solution</strong></p>

<p>Fortunately, Ruby on Rails includes a function that addresses the first concern. This method is the class-level delegate method. This method provides a shortcut for indicating that one or more methods that will be created on your object are actually provided by a related object. Using this delegate method, you can rewrite your exam- ple like this:</p>

<pre><code>class Customer &lt; ActiveRecord::Base 
    has_one :address        has_many :invoices              delegate :street, :city, :state, :zip_code, :to =&gt; :address
end
class Invoice &lt; ActiveRecord::Base      belongs_to :customer        delegate :name,              :street,                :to =&gt; :customer,               :prefix =&gt; true
end
</code></pre>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Ruby Way]]></title>
    <link href="http://karmaQ.github.com/blog/2012/06/26/ruby-way/"/>
    <updated>2012-06-26T09:55:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/06/26/ruby-way</id>
    <content type="html"><![CDATA[<p>面试时发现了自己的很多不足,从今天起再次系统的学习一下Ruby</p>

<h3>Ruby.new</h3>

<hr />

<ul>
<li>类是状态和使用这些状态的方法的组合</li>
<li>标准的构造函数成为new</li>
<li>方法是通过向对象发送该消息来唤起调用的,消息包含方法名称以及方法可能需要的参数.(来自smalltalk)</li>
<li>点(&#8220;.&#8221;)之前的东西称为receiver ,点后边的名字是调用的方法</li>
<li>代码写在一行的话,可以用分号分句</li>
<li>名称的第一个字符表示这个名称如何被使用: 局部变量,方法参数和方法名都以小写字母或者下划线开始,全局变量以美元符号为前缀,实例变量以@开始,类变量则以@@开始,最后类名称,模块名称都必须以大写祖母开始(@后不可直接跟数字).</li>
<li>包含多个单词的实例变量名称在词与词之间用下划线连接,类变量则以很合大小写方式区分</li>
</ul>


<hr />

<ul>
<li>nil是一个对象,不表示任何东西</li>
<li>nil和false代表false,其余的都是true(包括0)</li>
<li>语句修饰符(satement modifiers)</li>
<li>/patten/ 正则表达式也是对象</li>
<li>=~ 匹配操作符,用于匹配字符串,他返回的是模式开始的位置,否则返回nil</li>
<li>block只是在花括号或者do..end之间的一组代码(花括号的绑定更紧一些),一般来说单行的时候使用花括号,多行使用do/end</li>
<li>把block放在含有方法调用的源码行的结尾处可以实现关联,参数在block之前,方法可以使用yield一次或者多次的调用(incoke)block.</li>
<li>在block中||之间给出的参数名来自yield</li>
</ul>


<h3>Classes,Objects and Variables</h3>

<ul>
<li>initialize 方法把调用new时所使用的参数传入该方法</li>
<li>每个对象都有对实例变量的一份拷贝</li>
<li>Ruby中类永远都不是封闭的,可以打开并添加新的feature</li>
<li>用 &lt; 表示继承 , super 回想当前对象的弗雷发送一个消息,要求它调用子类中的同名方法.</li>
<li>当定义一个类而没有指定父类时,Ruby默认以object类作为其父类</li>
<li>Ruby可以通过创建一个名字以等号接的方法来达成这一目标,这些方法可以作为赋值操作的目标</li>
<li>attr_reader attr_writer</li>
<li>属性就是一个方法,通过方法暴漏出来的外部形态我们称之为属性,其他的动作就是方法.</li>
<li>类变量被所有的对象共享,并且只存在一份拷贝,类变量在使用前必须被初始化(通常就是赋值).</li>
<li>类变量对类及其实例都是似有的,如果你想让他们都能够被外部世界访问,需要通过实例方法或者类方法.</li>
<li>通过在方法名之前防止类名(.)来定义类方法,或者使用self.以及class &lt;&lt;self 来定义类方法</li>
<li>通过private_class_method :mothed_name 来将方法私有化.</li>
<li>public 可以被任何人调用,没有访问限制,方法默认是public的,protected方法只能被定义了该方法的类或其子类的对象所调用,整个家族均可访问,private方法不能被明确的接收者调用</li>
<li>访问控制是在程序运行时动态判定的,只有当代码试图执行首先的方法时才会得到一个访问违规.</li>
<li>使用pubilc,protected,private三个函数来为类或者模块定义方法的指定访问级别,也可以将方法名作为参数列表传入访问控制函数来设置他们的访问级别</li>
<li>变量是对象的引用而不是对象,对象大多保存在堆中,并且由变量指向他们</li>
<li>使用dup来避免创建别名</li>
</ul>


<h3>Containers,Blocks and Iterators</h3>

<ul>
<li></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Lets Rspec]]></title>
    <link href="http://karmaQ.github.com/blog/2012/06/05/lets-rspec/"/>
    <updated>2012-06-05T11:16:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/06/05/lets-rspec</id>
    <content type="html"><![CDATA[
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Rails Tutorial]Bundler and Gems]]></title>
    <link href="http://karmaQ.github.com/blog/2012/05/28/bundler-and-gems/"/>
    <updated>2012-05-28T12:41:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/05/28/bundler-and-gems</id>
    <content type="html"><![CDATA[<p>rails 3 中新增加了一个Library管理工具 <a href="http://gembundler.com/">Bundler</a>，它提供了好的工具来管理rails3项目依赖的gems。我们需要通过Gemfile来管理requires.</p>

<p>下面是Gemfile的一般写法：</p>

<p>每个Gemfile至少要依赖于一个以上的源，通过以下的形式进行声明：</p>

<pre><code>source :rubygems
source "http://rubygems.org"
source :rubyforge
source "http://gems.rubyforge.org"
source :gemcutter
source "http://gemcutter.org"
</code></pre>

<p>当然的由于众所周知的墙的问题，使用上边的源可能会出现某些问题…我推荐使用淘宝提供的墙内源：</p>

<pre><code>source 'http://ruby.taobao.org'
</code></pre>

<p>通过gem关键字来声明所依赖的Gems</p>

<pre><code>gem "nokogiri"
gem "rails", "3.0.0.beta3"
gem "rack",  "&gt;=1.0"
gem "thin",  "~&gt;1.1"
</code></pre>

<p>第一个参数是gem的名字，第二个参数可以指定版本，后边说明符的用法如下</p>

<ul>
<li>首先是类似于 3.0.0.beta3 这样直接指定版本号</li>
<li>>= 1.0 表示大于1.0版本</li>
<li>~> 比较有意思，我们用一个例子来说明 ~> 2.0.3 就相当于 >= 2.0.3 并且 &lt; 2.1. ~> 2.1 表示 >= 2.1 并且 &lt; 3.0. ~> 2.2.beta 将匹配类似与 2.2.beta.12 的版本号。</li>
</ul>


<p>关于Gems的详细介绍可以参见<a href="http://docs.rubygems.org/read/chapter/16#page74">这里</a></p>

<ul>
<li>Version 2.1.0 — 基版本</li>
<li>Version 2.2.0 — 引入了一些新特性</li>
<li>Version 2.2.1 — 修正一些Bugs</li>
<li>Version 2.2.2 — 精简了代码</li>
<li>Version 2.3.0 — 更多的新特性</li>
<li>Version 3.0.0 — 重写了接口. 应用 2.x 的代码可能会出现兼容性问题。</li>
</ul>


<p>如果 require 的档名不同，可以加上 :require 参数</p>

<pre><code>gem "rspec", :require =&gt; "spec"
gem "sqlite3-ruby", "1.2.5", :require =&gt; "sqlite3"
gem "gem-release", :require =&gt; false
gem "redis", :require =&gt; ["redis/connection/hiredis", "redis"]
</code></pre>

<p>更神奇的是还可以用 Git 当做来源，甚至可以指定 branch, tag 或 ref，当然了默认的 branch 是 master 啦。</p>

<pre><code>gem "nokogiri", :git =&gt; "git://github.com/tenderlove/nokogiri.git", :branch =&gt; "1.4" git "git://github.com/wycats/thor.git", :tag =&gt; "v0.13.4"
gem "thor"
</code></pre>

<p>如果你是一个Gem的开发者，你还可以直接指定本地的gem哦</p>

<pre><code>gem "nokogiri", :path =&gt; "~/sw/gems/nokogiri"
</code></pre>

<p>最后还要介绍一个比较重要的关键字 Group,可以指定某些Gem在特定的环境下被加载：</p>

<pre><code>gem "wirble", :group =&gt; :development
gem "ruby-debug", :group =&gt; [:development, :test]
group :test do
  gem "rspec"
end
</code></pre>

<p>没有指定 Group 的Gems是属于 Default Group 的。
通过 Group 我们可以更方便的执行 Bundle ，比如</p>

<pre><code>$ bundle install --without test development
</code></pre>

<p>Group的功能还是很强大的，大多数特性咱也不太会用的说，<a href="http://yehudakatz.com/2010/05/09/the-how-and-why-of-bundler-groups/">这里</a>有老外写的某文章，可以看看啦。</p>

<p>直接执行<code>$ bundle</code>可以列出常用的命令，比如</p>

<pre><code>bundle check        # 检查目前缺少哪些Gems
bundle init         # 在当前目录生成Gemfile
bundle install      # 根据Gemfile安装环境到当前的系统
</code></pre>

<hr />

<p>关于 RubyGems 我觉得没理由不看<a href="http://docs.rubygems.org/read/chapter/1">官方文档</a>的吧，各个方面都特别详细，有时间好好看看.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Rails Tutorial] 自动化测试环境]]></title>
    <link href="http://karmaQ.github.com/blog/2012/05/27/our-first-tests/"/>
    <updated>2012-05-27T16:22:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/05/27/our-first-tests</id>
    <content type="html"><![CDATA[<p>今天的这篇主要参考的Ruby-China的<a href="http://ruby-china.org/topics/2990">这篇帖子</a>，基本是照搬…Orz</p>

<h4>1、 新建项目(不启用Test::Unit，不执行Bundle)</h4>

<pre><code>$ rails new appname --skip-test-unit --skip-bundle
</code></pre>

<h4>2、 修改 Gemfile ,并 bundle install</h4>

<p>OS X 要安装 growl-notify ，是<a href="http://growl.info/extras.php">这里</a>还是<a href="http://soft.macx.cn/Growl133-3189.htm">这里</a>，就看你了。
liveload的<a href="http://help.livereload.com/kb/general-use/browser-extensions">浏览器扩展</a></p>

<figure class='code'><figcaption><span> (Gemfile)</span> <a href='http://karmaQ.github.com/downloads/code/our_first_tests/Gemfile'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rbconfig&#39;</span>
</span><span class='line'><span class="no">HOST_OS</span> <span class="o">=</span> <span class="no">RbConfig</span><span class="o">::</span><span class="no">CONFIG</span><span class="o">[</span><span class="s1">&#39;host_os&#39;</span><span class="o">]</span>
</span><span class='line'><span class="n">source</span> <span class="s1">&#39;http://rubygems.org&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;rails&#39;</span><span class="p">,</span> <span class="s1">&#39;3.2.3&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Gems used only for assets and not required</span>
</span><span class='line'><span class="c1"># in production environments by default.</span>
</span><span class='line'><span class="n">group</span> <span class="ss">:assets</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;sass-rails&#39;</span><span class="p">,</span>   <span class="s1">&#39;~&gt; 3.2.3&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;coffee-rails&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 3.2.1&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;uglifier&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;= 1.0.3&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;jquery-rails&#39;</span>
</span><span class='line'><span class="n">gem</span> <span class="s1">&#39;rspec-rails&#39;</span> <span class="p">,</span><span class="ss">:group</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="ss">:development</span><span class="p">,</span><span class="ss">:test</span><span class="o">]</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># jquery-ui</span>
</span><span class='line'><span class="c1"># gem &#39;jquery-ui-rails&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># bootstrap</span>
</span><span class='line'><span class="c1"># gem &#39;anjlab-bootstrap-rails&#39;, :require =&gt; &#39;bootstrap-rails&#39;,:git =&gt; &#39;git://github.com/anjlab/bootstrap-rails.git&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="k">if</span> <span class="no">HOST_OS</span> <span class="o">=~</span> <span class="sr">/linux/i</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;therubyracer&#39;</span><span class="p">,</span> <span class="s1">&#39;&gt;= 0.8.2&#39;</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'><span class="k">case</span> <span class="no">HOST_OS</span>
</span><span class='line'>  <span class="k">when</span> <span class="sr">/darwin/i</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;rb-fsevent&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;growl&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;guard-pow&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>  <span class="k">when</span> <span class="sr">/linux/i</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;libnotify&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;rb-inotify&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>  <span class="k">when</span> <span class="sr">/mswin|windows/i</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;rb-fchange&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;win32console&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'>    <span class="n">gem</span> <span class="s1">&#39;rb-notifu&#39;</span><span class="p">,</span> <span class="ss">:group</span> <span class="o">=&gt;</span> <span class="ss">:development</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'><span class="c1"># Use unicorn as the web server</span>
</span><span class='line'><span class="c1"># gem &#39;unicorn&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># Deploy with Capistrano</span>
</span><span class='line'><span class="c1"># gem &#39;capistrano&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="c1"># To use debugger</span>
</span><span class='line'><span class="c1"># gem &#39;ruby-debug19&#39;, :require =&gt; &#39;ruby-debug&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="n">group</span> <span class="ss">:test</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># Pretty printed test output</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;turn&#39;</span><span class="p">,</span> <span class="ss">:require</span> <span class="o">=&gt;</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;factory_girl_rails&#39;</span> <span class="p">,</span> <span class="s2">&quot;~&gt; 1.1.0&quot;</span> <span class="p">,</span><span class="ss">:require</span> <span class="o">=&gt;</span> <span class="kp">false</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;database_cleaner&#39;</span><span class="p">,</span> <span class="s2">&quot;&gt;= 0.6.7&quot;</span>
</span><span class='line'>  <span class="c1"># gem &#39;mongoid-rspec&#39;, &quot;&gt;= 1.4.4&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;capybara&quot;</span><span class="p">,</span><span class="s2">&quot;&gt;= 1.1.1&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;launchy&quot;</span><span class="p">,</span> <span class="s2">&quot;&gt;= 2.0.5&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard-spork&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;spork&#39;</span><span class="p">,</span> <span class="s1">&#39;~&gt; 0.9.0&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s2">&quot;guard-rspec&quot;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard-livereload&#39;</span>
</span><span class='line'>  <span class="n">gem</span> <span class="s1">&#39;guard-bundler&#39;</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>3、 初始化 Rspec，Guard， Spork</h4>

<pre><code>$ rails g rspec:install
$ guard init
</code></pre>

<p><del>$ bin/guard init rspec &amp;&amp; bin/guard init spork</del></p>

<p>修改 Guardfile</p>

<figure class='code'><figcaption><span> (Guardfile)</span> <a href='http://karmaQ.github.com/downloads/code/our_first_tests/Guardfile'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="c1"># A sample Guardfile</span>
</span><span class='line'><span class="c1"># More info at https://github.com/guard/guard#readme</span>
</span><span class='line'><span class="n">guard</span> <span class="s1">&#39;livereload&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{app/.+\.(erb|haml)}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{app/helpers/.+\.rb}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{(public/|app/assets).+\.(css|js|html)}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{(app/assets/.+\.css)\.s[ac]ss}</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{(app/assets/.+\.js)\.coffee}</span><span class="p">)</span> <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{config/locales/.+\.yml}</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">guard</span> <span class="s1">&#39;pow&#39;</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;.powrc&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;.powenv&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;.rvmrc&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;Gemfile&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;Gemfile.lock&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;config/application.rb&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;config/environment.rb&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^config/environments/.*\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^config/initializers/.*\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^config/settings(\.local)?\.yml$}</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">guard</span> <span class="s1">&#39;spork&#39;</span><span class="p">,</span> <span class="ss">:cucumber_env</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;RAILS_ENV&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span> <span class="p">},</span> <span class="ss">:rspec_env</span> <span class="o">=&gt;</span> <span class="p">{</span> <span class="s1">&#39;RAILS_ENV&#39;</span> <span class="o">=&gt;</span> <span class="s1">&#39;test&#39;</span> <span class="p">}</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;config/application.rb&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;config/environment.rb&#39;</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^config/environments/.+\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^config/initializers/.+\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;spec/spec_helper.rb&#39;</span><span class="p">)</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="n">guard</span> <span class="s1">&#39;rspec&#39;</span><span class="p">,</span> <span class="ss">:version</span> <span class="o">=&gt;</span> <span class="mi">2</span> <span class="p">,</span><span class="ss">:cli</span> <span class="o">=&gt;</span> <span class="s2">&quot;--drb&quot;</span><span class="p">,</span><span class="ss">:notification</span> <span class="o">=&gt;</span> <span class="kp">true</span> <span class="k">do</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^spec/.+_spec\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^lib/(.+)\.rb$}</span><span class="p">)</span>     <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="s2">&quot;spec/lib/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;spec/spec_helper.rb&#39;</span><span class="p">)</span>  <span class="p">{</span> <span class="s2">&quot;spec/&quot;</span> <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Rails example</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^spec/.+_spec\.rb$}</span><span class="p">)</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^app/(.+)\.rb$}</span><span class="p">)</span>                           <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="s2">&quot;spec/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^lib/(.+)\.rb$}</span><span class="p">)</span>                           <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="s2">&quot;spec/lib/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^app/controllers/(.+)_(controller)\.rb$}</span><span class="p">)</span>  <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="o">[</span><span class="s2">&quot;spec/routing/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_routing_spec.rb&quot;</span><span class="p">,</span> <span class="s2">&quot;spec/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="si">}</span><span class="s2">s/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span><span class="p">,</span> <span class="s2">&quot;spec/acceptance/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span><span class="o">]</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^spec/support/(.+)\.rb$}</span><span class="p">)</span>                  <span class="p">{</span> <span class="s2">&quot;spec/&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;spec/spec_helper.rb&#39;</span><span class="p">)</span>                        <span class="p">{</span> <span class="s2">&quot;spec/&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;config/routes.rb&#39;</span><span class="p">)</span>                           <span class="p">{</span> <span class="s2">&quot;spec/routing&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="s1">&#39;app/controllers/application_controller.rb&#39;</span><span class="p">)</span>  <span class="p">{</span> <span class="s2">&quot;spec/controllers&quot;</span> <span class="p">}</span>
</span><span class='line'>  <span class="c1"># Capybara request specs</span>
</span><span class='line'>  <span class="n">watch</span><span class="p">(</span><span class="sr">%r{^app/views/(.+)/.*\.(erb|haml)$}</span><span class="p">)</span>          <span class="p">{</span> <span class="o">|</span><span class="n">m</span><span class="o">|</span> <span class="s2">&quot;spec/requests/</span><span class="si">#{</span><span class="n">m</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="si">}</span><span class="s2">_spec.rb&quot;</span> <span class="p">}</span>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>4、 修改 spechelper</h4>

<p>如果你没有使用activerecorder 一定要按注释修改文件.</p>

<figure class='code'><figcaption><span> (spec_helper.rb)</span> <a href='http://karmaQ.github.com/downloads/code/our_first_tests/spec_helper.rb'>download</a></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
</pre></td><td class='code'><pre><code class='ruby'><span class='line'><span class="nb">require</span> <span class="s1">&#39;rubygems&#39;</span>
</span><span class='line'><span class="nb">require</span> <span class="s1">&#39;spork&#39;</span>
</span><span class='line'>
</span><span class='line'><span class="no">Spork</span><span class="o">.</span><span class="n">prefork</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># Loading more in this block will cause your tests to run faster. However, </span>
</span><span class='line'>  <span class="c1"># if you change any configuration or code from libraries loaded here, you&#39;ll</span>
</span><span class='line'>  <span class="c1"># need to restart spork for it take effect.</span>
</span><span class='line'>  <span class="c1"># This file is copied to spec/ when you run &#39;rails generate rspec:install&#39;</span>
</span><span class='line'>  <span class="no">ENV</span><span class="o">[</span><span class="s2">&quot;RAILS_ENV&quot;</span><span class="o">]</span> <span class="o">||=</span> <span class="s1">&#39;test&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="no">File</span><span class="o">.</span><span class="n">expand_path</span><span class="p">(</span><span class="s2">&quot;../../config/environment&quot;</span><span class="p">,</span> <span class="bp">__FILE__</span><span class="p">)</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;rspec/rails&#39;</span>
</span><span class='line'>  <span class="nb">require</span> <span class="s1">&#39;rspec/autorun&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="c1"># Requires supporting ruby files with custom matchers and macros, etc,</span>
</span><span class='line'>  <span class="c1"># in spec/support/ and its subdirectories.</span>
</span><span class='line'>  <span class="no">Dir</span><span class="o">[</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;spec/support/**/*.rb&quot;</span><span class="p">)</span><span class="o">].</span><span class="n">each</span> <span class="p">{</span><span class="o">|</span><span class="n">f</span><span class="o">|</span> <span class="nb">require</span> <span class="n">f</span><span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="no">RSpec</span><span class="o">.</span><span class="n">configure</span> <span class="k">do</span> <span class="o">|</span><span class="n">config</span><span class="o">|</span>
</span><span class='line'>    <span class="c1"># == Mock Framework</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># If you prefer to use mocha, flexmock or RR, uncomment the appropriate line:</span>
</span><span class='line'>    <span class="c1">#</span>
</span><span class='line'>    <span class="c1"># config.mock_with :mocha</span>
</span><span class='line'>    <span class="c1"># config.mock_with :flexmock</span>
</span><span class='line'>    <span class="c1"># config.mock_with :rr</span>
</span><span class='line'>    <span class="n">config</span><span class="o">.</span><span class="n">mock_with</span> <span class="ss">:rspec</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># Remove this line if you&#39;re not using ActiveRecord or ActiveRecord fixtures</span>
</span><span class='line'>    <span class="n">config</span><span class="o">.</span><span class="n">fixture_path</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">#{</span><span class="o">::</span><span class="no">Rails</span><span class="o">.</span><span class="n">root</span><span class="si">}</span><span class="s2">/spec/fixtures&quot;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># If you&#39;re not using ActiveRecord, or you&#39;d prefer not to run each of your</span>
</span><span class='line'>    <span class="c1"># examples within a transaction, remove the following line or assign false</span>
</span><span class='line'>    <span class="c1"># instead of true.</span>
</span><span class='line'>    <span class="n">config</span><span class="o">.</span><span class="n">use_transactional_fixtures</span> <span class="o">=</span> <span class="kp">true</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1"># If true, the base class of anonymous controllers will be inferred</span>
</span><span class='line'>    <span class="c1"># automatically. This will be the default behavior in future versions of</span>
</span><span class='line'>    <span class="c1"># rspec-rails.</span>
</span><span class='line'>    <span class="n">config</span><span class="o">.</span><span class="n">infer_base_class_for_anonymous_controllers</span> <span class="o">=</span> <span class="kp">false</span>
</span><span class='line'>  <span class="k">end</span>
</span><span class='line'><span class="k">end</span>
</span><span class='line'>
</span><span class='line'><span class="no">Spork</span><span class="o">.</span><span class="n">each_run</span> <span class="k">do</span>
</span><span class='line'>  <span class="c1"># This code will be run each time you run your specs.</span>
</span><span class='line'>
</span><span class='line'><span class="k">end</span>
</span></code></pre></td></tr></table></div></figure>


<h4>5、执行 <code>$ bundle exec spork --bootstrap</code></h4>

<h4>6、以后只要运行 <code>$ guard</code> 就可以了</h4>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[[Rails Tutorial] 从零开始搭建 Ruby on Rails 开发环境]]></title>
    <link href="http://karmaQ.github.com/blog/2012/05/26/from-zero-to-deploy/"/>
    <updated>2012-05-26T00:01:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/05/26/from-zero-to-deploy</id>
    <content type="html"><![CDATA[<p>去年8月份开始接触RoR，之后虽然做过几个小的App但是并没有对Rails进行一个系统的学习，翻看之前的代码，简直惨不忍睹，并且带有浓重的C# Style，今天捧起“Ruby on Rails 3 Tutorial”开始从头学起，从今以后将作为一个Rubyist开始新的生活。</p>

<hr />

<h2>搭建开发环境</h2>

<h4>1、安装Git</h4>

<p>通过<a href="http://code.google.com/p/git-osx-installer/">git-osx-installer</a>进行安装，异常的简单，简单的使用教程可以看<a href="http://rogerdudler.github.com/git-guide/index.zh.html">这里</a>。</p>

<h4>2、安装Xcode</h4>

<p>之后要下载并安装<a href="https://developer.apple.com/downloads/index.action">Xcode</a>,当然了主要是Command Line Tools for Xcode。</p>

<h4>3、安装Homebrew</h4>

<p>这里先推荐的一个东西<a href="http://mxcl.github.com/homebrew/">homebrew</a>,Mac OS X 下新的软件包管理工具，比较方便的，之后就可以使用类似<code>$ brew install unrar</code>的命令管理包了，安装方法：</p>

<pre><code>/usr/bin/ruby -e "$(/usr/bin/curl -fsSL https://raw.github.com/mxcl/homebrew/master/Library/Contributions/install_homebrew.rb)"
</code></pre>

<p>也可以按照<a href="http://blog.jjgod.org/2009/12/21/homebrew-package-management/">这篇文章</a>中的做法进行安装:</p>

<p>首先，Homebrew 的原则是“No sudo”，也就是说，既然 Mac OS X (client 版本) 绝大部分情况下都是归你这个有管理员权限的用户，为什么在自己的 /usr/local 下安装程序还需要 sudo 呢？所以，首先：</p>

<pre><code>$ sudo chown -R \`whoami` /usr/local
</code></pre>

<p>然后可以正式开始安装，我推荐的安装方式是先用 git-osx-installer 装上 git，然后用 git 安装：</p>

<pre><code>$ cd /usr/local
$ git init
$ git remote add origin git://github.com/mxcl/
$ homebrew.git
$ git pull origin master
</code></pre>

<p>这么做的实际作用是把你的 /usr/local 目录变成了一个本地 git 仓库，只不过这个仓库只跟踪跟 Homebrew 相关的更新，并不影响任何其他软件的安装。</p>

<p>这样安装会在 /usr/local 下创建 Library 这个目录，然后在 /usr/local/bin 中加入 brew 这个 ruby 脚本。</p>

<h4>4、安装 RVM</h4>

<pre><code>$ bash -s stable &lt; &lt;(curl -s https://raw.github.com/wayneeseguin/rvm/master/binscripts/rvm-installer)  
</code></pre>

<p>等待rvm安装好之后，配置环境变量，在当前用户目录下输入</p>

<pre><code>sudo vim .bash_profile 
</code></pre>

<p>在其中加入</p>

<pre><code>[[ -s "$HOME/.rvm/scripts/rvm" ]] &amp;&amp; source "$HOME/.rvm/scripts/rvm"
</code></pre>

<p>source一下即可。</p>

<p>安装Ruby，并设置默认版本(当前最新的是1.9.3)</p>

<pre><code>$ rvm install ruby --head 
$ rvm use 1.9.3 --default
</code></pre>

<p>更换源</p>

<pre><code>$ [sudo] gem update --system  
$ [sudo] gem uninstall rubygems-update  
$ [sudo] gem sources -r http://rubygems.org/  
$ [sudo] gem sources -a http://ruby.taobao.org  
</code></pre>

<h4>5、安装rails</h4>

<pre><code>$ gem install rails -V
</code></pre>

<p>至此，rails的应该已经可以使用了。</p>

<h4>6、选定编辑器</h4>

<p>Mac下边就Textmate或者Macvim，我选的是后起之秀<a href="http://www.sublimetext.com/">Sublime Text 2</a></p>

<p>详细的介绍和使用推荐<a href="http://ruby-china.org/">Ruby-China</a>的一篇<a href="http://ruby-china.org/topics/3107">帖子</a></p>

<p>一些常用的快捷键</p>

<ul>
<li>快如闪电查找文件：Ctrl + P</li>
<li>方法查找或行定位(用在Ctrl + P后)：@ / # /</li>
<li>快捷命令板：Ctrl + Shift + P</li>
<li>控制台：Ctrl + \</li>
<li>包控制：Package Control</li>
<li>快速代码书写：Zen Coding</li>
<li>对齐(Ctrl + Alt + A)：Alignment</li>
<li>无干扰编辑：Shift + F11</li>
</ul>


<hr />

<h2>使用 Git 进行版本控制</h2>

<h4>1、全局设置</h4>

<p>首先是设置用户名和邮箱</p>

<pre><code>$ git config --global user.name "Your Name" $ git config --global user.email youremail@example.com

$ git config --global color.diff auto
$ git config --global color.status auto
$ git config --global color.branch auto
$ git config --global color.interactive auto
$ git config --global color.ui auto
</code></pre>

<p>当然了也可以直接编辑<code>~/.gitconfig</code>，查看配置<code>$ git config --list</code></p>

<p>为了方便起见，做一些快捷设置(别名而已)</p>

<pre><code>$ git config --global alias.co checkout
</code></pre>

<p>然后就是设置Git的默认编辑器,我用的是Sublime Text 2</p>

<pre><code>$ git config --global core.editor "subl -w"
</code></pre>

<p>如果使用 textmate 就把subl -w换成mate -w,同理gvim对应 &#8220;gvim -f&#8221;,MacVim对应&#8221;mvim -f&#8221;，而gedit则对应&#8221;gedit -s&#8221;。</p>

<p>然后初始化一下下</p>

<pre><code>$ git init
</code></pre>

<p><code>.gitignore</code>是忽略列表，Rails会自动生成一个的。</p>

<h4>2、Adding and Committing</h4>

<p>添加文件并且commit, -m 添加了一个消息，如果不写-m的话，会弹出编辑器让你添加的。</p>

<pre><code>$ git add .
$ git commit -m "Initial commit"
</code></pre>

<p>使用 <code>$ git status</code>可以查看当前版本的状态，<code>$ git log</code> 查看日志，<code>$ git checkout -f</code>来恢复到上一个版本。</p>

<p>嘛，更多的命令在<a href="http://www.kernel.org/pub/software/scm/git/docs/v1.4.4.4/tutorial.html">这里</a>，详细的介绍要参考<a href="http://zh.wikipedia.org/wiki/Git">Wiki</a>。</p>

<h4>3、Github</h4>

<p>其实最好的教程还是官方的<a href="http://help.github.com/">文档</a>啦，简单全面，我在这里再稍微啰嗦几句。</p>

<p>首先要申请一个Github的账号，并且建立一个新的Repository，然后执行下面的命令</p>

<pre><code>$ git remote add origin git@github.com:&lt;username&gt;/&lt;Repositoryname&gt;.git
$ git push origin master
</code></pre>

<p>这里其实是给Repository的地址起了一个别名而已，之后可以在项目文件夹下的<code>.git/config</code>中修改和删除。</p>

<p>通过 -b 签出一个新的分支，不加-b的话就是切换分支,通过<code>$ git branch</code>可以查看分支</p>

<pre><code>$ git checkout -b new_branch
</code></pre>

<p>通过<code>$ git merge &lt;branch&gt;</code>来合并分支，-d是删除，-D强制删除。</p>

<p>另一个比较常用的命令就是<code>$ git push</code>了，当然了要想push到github上需要先生成密钥对</p>

<pre><code>#ssh-keygen -t rsa -C "xxx@mail.com"。
</code></pre>

<p>把生成的密钥粘贴在Github的设置中。</p>

<p>补充一本书 <a href="http://www-cs-students.stanford.edu/%7Eblynn/gitmagic/intl/zh_cn/index.html">Git Magic</a></p>

<h4>4、部署在Heroku</h4>

<p>安装并添加密钥对：</p>

<pre><code>$ [sudo] gem install heroku
$ heroku keys:add
</code></pre>

<p> 申请<a href="http://www.heroku.com/">Heroku</a>账号，并创建一个App</p>

<pre><code>$ heroku create
</code></pre>

<p> Push过去就可以了</p>

<pre><code>$ git push heroku master
</code></pre>

<h2>尾声</h2>

<p>折腾了半天，环境总算是弄好了，准备开发了。</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Hello Github]]></title>
    <link href="http://karmaQ.github.com/blog/2012/05/25/hello-github/"/>
    <updated>2012-05-25T23:16:00+08:00</updated>
    <id>http://karmaQ.github.com/blog/2012/05/25/hello-github</id>
    <content type="html"><![CDATA[<p>这是一篇测试的文章。</p>

<h4>首先来测试一下Markdows的语法</h4>

<blockquote><pre><code>这里是一段引用。
</code></pre></blockquote>

<h4>最近想要学习的东西</h4>

<ul>
<li>Ruby on Rails</li>
<li>Rspec</li>
<li>日语</li>
<li>英语 XD</li>
</ul>


<hr />

<h4>嘛 当然要测试一下代码的排版了</h4>

<p>This is a code block.</p>

<pre><code>class CleanRoom
    def a_useful_method(x);x*2;end
end 
</code></pre>

<p>Use the <code>a_useful_method()</code> function.</p>

<p>唉？居然是这样的么，语法还是很不熟悉啊，关于代码应该还会有更好的<em>解决方案</em>吧，明天再弄吧。</p>
]]></content>
  </entry>
  
</feed>
